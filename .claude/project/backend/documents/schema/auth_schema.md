# Auth スキーマ

## 概要

認証関連のAPI入出力データ構造を定義するPydanticスキーマです。ユーザー登録、ログイン、ログアウト機能のためのバリデーション機能とデータ変換機能を提供します。

## 主要な schema の説明

### schema の名前
auth.py - 認証関連スキーマ集

### schema の概要
認証システムAPIの以下の場面で使用されるデータ構造を定義：
- ユーザー新規登録時の入力・出力データ
- ユーザーログイン時の入力・出力データ
- ユーザーログアウト時の出力データ
- 認証エラー時の出力データ
- JWTトークン形式の定義

### schema のアーキテクチャ

#### 1. SignupRequest
**用途**: ユーザー新規登録時の入力データ
**フィールド**:
- `email: EmailStr` - メールアドレス（メール形式バリデーション）
- `password: str` - パスワード（最小8文字）
**特徴**: EmailStrによる自動メール形式検証、パスワード最小長制限

#### 2. SignupResponse
**用途**: ユーザー新規登録成功時の出力データ
**フィールド**:
- `id: str` - ユーザーUUID
- `email: str` - 登録されたメールアドレス
- `message: str` - 成功メッセージ
**特徴**: 登録完了確認情報を提供

#### 3. LoginRequest
**用途**: ユーザーログイン時の入力データ
**フィールド**:
- `email: EmailStr` - メールアドレス（メール形式バリデーション）
- `password: str` - パスワード
**特徴**: メール形式の自動検証

#### 4. LoginResponse
**用途**: ユーザーログイン成功時の出力データ
**フィールド**:
- `id: str` - ユーザーUUID
- `email: str` - ログインユーザーのメールアドレス
- `token: str` - JWTアクセストークン
- `message: str` - 成功メッセージ
**特徴**: 認証トークンとユーザー情報を含む

#### 5. LogoutResponse
**用途**: ユーザーログアウト時の出力データ
**フィールド**:
- `message: str` - ログアウト完了メッセージ
**特徴**: シンプルな完了確認

#### 6. AuthError
**用途**: 認証エラー時の出力データ
**フィールド**:
- `message: str` - エラーメッセージ
- `code: str | None` - エラーコード（任意）
**特徴**: 統一されたエラー形式

#### 7. Token
**用途**: JWTトークンの標準形式
**フィールド**:
- `access_token: str` - JWTトークン
- `token_type: str` - トークンタイプ（デフォルト: "bearer"）
**特徴**: OAuth2標準に準拠

#### 8. 互換性エイリアス
**UserCreate**: SignupRequestのエイリアス
**UserLogin**: LoginRequestのエイリアス
**AuthResponse**: LoginResponseのエイリアス
**特徴**: 既存コードとの互換性を保持

### バリデーション機能

1. **メール形式検証**:
   - EmailStr型による自動メール形式チェック
   - 不正なメール形式の自動拒否

2. **パスワード制限**:
   - 最小8文字の制限
   - セキュリティ要件の enforcing

3. **データ型検証**:
   - Pydanticによる自動型チェック
   - 不正なデータ型の自動拒否

### セキュリティ考慮事項

1. **パスワード長制限**: 最小8文字でセキュリティを確保
2. **メール検証**: 有効なメールアドレスのみ受付
3. **トークン形式**: 標準的なBearer Token形式を採用

### 依存関係にあるファイル群

- `pydantic` - BaseModel, EmailStr, Field
- `models/user.py` - Userモデル（変換元）
- `routes/auth.py` - 認証APIエンドポイント（使用先）
- `lib/auth/user_manager.py` - ユーザー管理ビジネスロジック（使用先）

## ドキュメント更新履歴

- 2025-07-13: 初回作成